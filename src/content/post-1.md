---
title: "유저가 브라우저에 URL을 입력한 후 벌어지는 일들 -1"
date: "2021-09-06"
draft: false
path: "/blog/post-1"
---

이 시리즈는 츠토무 토네가 쓴 성공과 실패를 결정하는 1%의 네트워크 원리를 읽고 공부한 내용을 정리한 것으로,
유저가 브라우저에 URL을 입력한 후에 원했던 화면이 보이기까지 어떤 단계를 거치는지를 살펴본다.

[유저가 브라우저에 URL을 입력한 후 벌어지는 일들 -1](https://choichoikule.github.io/blog/post-1)  
[유저가 브라우저에 URL을 입력한 후 벌어지는 일들 -2](https://choichoikule.github.io/blog/post-7)

# Step1. URL을 분석한다

유저는 크롬,사파리와 같은 브라우저를 열고 주소창에 http://https://choichoikule.github.io/와 같은 주소를 입력한다.
이러한 주소를 url이라고 하며 유저가 원하는 인터넷 사이트를 나타내는 주소이다. 유저는 주소를 입력함으로써 원하는 것을 불러온다.

### URL이란

좀더 자세하게 이 url이란 것을 살펴볼 필요가 있을 것 같다. 모든 이해는 자세한 정의에서 출발하니까.  
url의 사전적 정의를 찾아보면 다음과 같다. Uniform Resource Locator(URL)은 인터넷 자원의 위치를 나타내는 것으로, 웹에 게시된 어떤 자원을 찾기위해
브라우저에 의해 사용되는 메카니즘이다. 어렵게 적혀 있지만 쉡게 말하면 그냥 브라우저가 사용하는 주소체계이다. 이 url은 단순한 문자열 나열이 아니라,
protocol + domain + port + path + parameter + fragment 의 순서대로 각각 의미를 담은 요소로 이루어져 있다.

protocol은 사용자가 입력한 자원 위치에서 자원을 가져오기 위해 브라우저가 어떤 프로토콜을 사용해야하는지 명시하는 것이다.
흔히 보는 URL 주소에서 http:// 부분을 말한다. 대부분 http프로토콜을 사용해 웹 페이지를 가져오는 용도로 브라우저를 사용하기 때문에
이외에 다른 것이 있다는 게 낯설지만, 브라우저에 ftp:// mailto://등의 프로토콜을 입력하여 파일업로드나 메일 송신등을 지시할 수도 있다.

domain은 웹서버이름을 나타내며, path는 웹서버상의 자원위치를 의미한다. 물리적인 위치를 나타낼수도 있지만 대부분 웹서버에서 추상화하여 표현한다.
parameter는 웹서버에 제공하는 추가 파라미터로, 이 파라미터들은 & 기호로 구분된 키/값으로 짝을 이룬 리스트이다.
fragment는 일종의 자원 안에서 "bookmark" 로 해당 위치로 스크롤되며 해당 부분은 서버로 요청이 보내지지 않는다.

<!-- 위에서 잠깐 언급했듯이 인터넷상의 자원들은 숫자로 이루어진 실질적인 주소인 IP 주소라는 것을 가지고 있다. 이러한 숫자들을 외우는 것보다 문자로된 이름을 지어 명명하는 것이 편하기 때문에 domain을 사용하지만
이 domain이름만으로는
## IP주소체계

TCP/IP 네트워크는 서브넷이라는 작은단위의 네트워크를 라우터로 연결하여 전체 네트워크를 완성하는데 네트워크의 번호와
호스트 번호를 합쳐서 IP주소라고 한다.
IPv4체계에서 IP 주소는 32비트의 디지털 데이터로, 8비트씩 점으로 구분하여 10진수로 표기한다.
네트워크 주소 영역이 어디까지인지에 따라 IP주소를 클래스로 구분할 수 있고, 해당 클래스에 따라 기본 서브넷 마스크가 주어진다.
기본 서브넷 마스크는 네트워크 주소부분의 비트를 1로, 호스트부분의 비트를 0으로 표시하며, IP 주소와 서브넷 마스크를 AND 연산 하면 네트워크 주소를 구할 수 있다.
보안과 효율을 위해 호스트 번호 구간을 분할하여 서브네트워크를 만들어서 사용할 수도 있다. -->

위에서 domain이 웹서버 이름이라고 하였는데, 실제로는 이 domain이름만으로는 인터넷 자원을 찾아올 수가 없다. 왜냐하면, url을 입력해서 무언가를 인터넷으로부터 불러온다는 것은 내 컴퓨터에 있지 않은,
네트워크로 연결된 어떠한 다른 장치에 있는 자원을 가져오는 것인데, 네트워크 상에서 연결된 이 각각의 장치들은 도메인과 같은 문자열로된 이름이 아니라 특수한 번호를 가지고 식별되기 때문이다.
이러한 특수한 번호를 IP주소라고 하며 유저가 입력하는 도메인 이름은 이러한 IP주소와 매칭되어 할당되므로 웹브라우저에 도메인을 입력하면, 브라우저가 IP주소와 도메인 이름의 매칭정보를 가지고 있는 Domain Name System(DNS)서버를 조회하여 맞는 IP주소를 찾아서 인터넷 자원을 가져오게된다. (좀더 상세한 과정이 생략되었지만 뒤에서 다시 설명하겠다.)

<!-- ### DNS서버를 조회하여 IP 주소 알아내기

DNS서버 역시 하나의 서버이므로 네트워크를 통해 데이터를 주고받는 과정이 필요하다.
데이터를 보내는 것은 어플리케이션의 단일 동작만으로는 불가능하며 컴퓨터 운영체제내부의 네트워크 제어 시스템이 함께 동작해야한다. 이 과정이 바로 그 유명한 OSI 7계층으로 표현된다.
DNS서버에 IP주소를 요청하기 위한 메세지 작성은 DNS 리졸버라고 하는 것이 담당하므로 브라우저는 리졸버를 호출하여 메세지 작성을 의뢰하고, 리졸버의 메세지가 전송되어 DNS서버로부터 응답이 오면 실제 IP주소를 알게된다고만 정리하고 다음 내용으로 넘어가겠다. -->

다음 스텝에 대해 설명하기 전에 OSI 7계층을 간단히 언급하고 넘어가고자 한다.
OSI7계층은 네트워크 통신이 일어나는 과정을 체계적으로 설명하기 위하여 개발된 모델로, 아래 이미지 오른쪽의 Layer 들로 구성이 된다.
각각의 계층을 거쳐야 네트워크 상에서 데이터를 주고 받을 수 있으며, 각 층에서 인식할 수 있는 헤더를 붙이고 그 헤더를 해석하는 방식으로 통신이 이루어진다.
요청을 보낼때에는 왼쪽의 화살표 방향대로 OSI의 각계층을 따라 내려가면서 헤더를 추가하고 네트워크로 부터 응답을 받을 때에는 맨 밑 계층에서부터 차례대로 올라오면서 헤더를 분석해서 최종 메세지를 받는다.

<img src="https://t1.daumcdn.net/cfile/tistory/99662A475B7CA8851A">

# step2 TCP,UDP/IP의 작동

위에서 설명했듯이 웹브라우저와 같은 어플리케이션의 단일한 작동으로는 데이터 통신이 이루어지지 않으므로, 실제 IP주소를 알아낸 브라우저가 다음으로 하는 일은 TCP/IP와 같은 전송계층에게 메세지 전송을 의뢰하는 것이다.
TCP/IP와 같은 전송계층은 시스템 운영체제 안에 구현되어 있어 사용자가 직접 이용할 수 없으므로 운영체제가 제공하는 소켓 인터페이스를 통해 시스템 콜로 동작을 의뢰할 수 있다.

Transmission Control Protocol(TCP)는 IP 네트워크의 두 컴퓨터 간의 연결 지향 통신을 위한 전송 계층 호스트 간 프로토콜입니다. TCP는 가상 포트를 사용하여 두 컴퓨터 간의 물리적 연결을 재사용 할 수 있는 가상 종단 간 연결을 만듭니다.
User Datagram Protocol(UDP)는 컴퓨터가 다른 컴퓨터와 데이터 통신을 하기 위한 규약(프로토콜)의 일종이다. UDP는 세계 통신표준으로 개발된 OSI 모형에서 4번째 계층인 전송 계층(Transport Layer)에서 사용하는 규약이다.

TCP/IP와 같은 전송계층은 시스템 운영체제 안에 구현되어 있으므로 사용자가 직접 이용할 수 없고 라이브러리 함수를 콜하는 시스템 콜 방식으로 기능을 사용할 수 있게 되어있다.

참고:  
[성공과 실패를 결정짓는 1%의 네트워크 원리](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=163484025)  
[참고블로그-OSI7계층에대한 정리](https://jins-dev.tistory.com/entry/OSI-7%EA%B3%84%EC%B8%B5OSI-7-Layer-%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A0%95%EB%A6%AC)  
[ITstory](https://copycode.tistory.com/32)
